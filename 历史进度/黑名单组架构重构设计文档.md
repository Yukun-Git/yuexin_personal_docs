# é»‘åå•æ¶æ„é‡æ„è®¾è®¡æ–‡æ¡£ (ç®€åŒ–ç‰ˆ)

## ğŸ“Š é¡¹ç›®æ¦‚å†µ

**é‡æ„é¡¹ç›®**: é»‘åå•ç®¡ç†ç³»ç»Ÿæ¶æ„é‡æ„  
**é‡æ„åŸå› **: å½“å‰æ¶æ„ä¸ç¬¦åˆä¸šåŠ¡éœ€æ±‚ï¼Œéœ€è¦æ”¯æŒ"é»‘åå•é›†åˆ"æ¦‚å¿µ  
**é‡æ„èŒƒå›´**: æ•°æ®åº“ã€åç«¯APIã€å‰ç«¯ç•Œé¢å…¨é¢é‡æ„  
**é¢„è®¡å·¥æœŸ**: 2ä¸ªå·¥ä½œæ—¥ / 12å°æ—¶ (ç®€åŒ–å)  
**é‡æ„çº§åˆ«**: æ¶æ„çº§åˆ«é‡æ„  
**è®¾è®¡åŸåˆ™**: å•ä¸€èŒè´£ï¼Œé»‘åå•åªç®¡ç†æ‰‹æœºå·ç æ•°æ®

## ğŸ¯ éœ€æ±‚åˆ†æ

### å½“å‰æ¶æ„é—®é¢˜

**ç°çŠ¶**:
- æ¯ä¸ªæ‰‹æœºå·éƒ½æ˜¯ç‹¬ç«‹çš„blacklist_entryè®°å½•
- æ— æ³•æ‰¹é‡ç®¡ç†æ‰‹æœºå·ç é›†åˆ
- ç•Œé¢ä¸Šç¼–è¾‘å•ä¸ªæ¡ç›®ï¼Œä¸ç¬¦åˆä¸šåŠ¡åœºæ™¯

**ä¸šåŠ¡éœ€æ±‚**:
- é»‘åå•æ˜¯æ‰‹æœºå·ç é›†åˆæ¦‚å¿µ
- ç®¡ç†ä»¥é»‘åå•ä¸ºå•ä½ï¼ˆå¯ç”¨/ç¦ç”¨æ•´ä¸ªé»‘åå•ï¼‰
- ç¼–è¾‘æ—¶èƒ½çœ‹åˆ°å’Œç®¡ç†é»‘åå•å†…çš„å®Œæ•´æ‰‹æœºå·åˆ—è¡¨
- æ”¯æŒæ‰¹é‡å¯¼å…¥/å¯¼å‡ºæ‰‹æœºå·ç 
- **å…³é”®ç®€åŒ–**: ä½œç”¨åŸŸç®¡ç†åœ¨ä½¿ç”¨ç«¯é…ç½®ï¼Œé»‘åå•æœ¬èº«åªç®¡ç†æ•°æ®

### ä¸šåŠ¡åœºæ™¯ç¤ºä¾‹

```
åƒåœ¾ç”µè¯é»‘åå•
â”œâ”€â”€ 138****1234
â”œâ”€â”€ 139****5678  
â”œâ”€â”€ 186****9999
â””â”€â”€ ... (å‡ ç™¾ä¸ªæ‰‹æœºå·)

å®¢æˆ·æŠ•è¯‰é»‘åå•
â”œâ”€â”€ 135****4567
â”œâ”€â”€ 187****8901
â””â”€â”€ ... (å‡ åä¸ªæ‰‹æœºå·)
```

### ä½œç”¨åŸŸä½¿ç”¨ç¤ºä¾‹ (åœ¨ä½¿ç”¨ç«¯é…ç½®)

```
å…¨å±€é…ç½®: ä½¿ç”¨é»‘åå• ["åƒåœ¾ç”µè¯é»‘åå•", "è¿æ³•å·ç é»‘åå•"]
è´¦å·Aé…ç½®: ä½¿ç”¨é»‘åå• ["å®¢æˆ·æŠ•è¯‰é»‘åå•"] 
é€šé“Bé…ç½®: ä½¿ç”¨é»‘åå• ["åƒåœ¾ç”µè¯é»‘åå•", "å®¢æˆ·æŠ•è¯‰é»‘åå•"]
```

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### ç®€åŒ–çš„è¡¨ç»“æ„ (ä¸“æ³¨æ‰‹æœºå·ç ç®¡ç†)

#### 1. blacklists (é»‘åå•è¡¨ - ä¸»è¡¨)

```sql
CREATE TABLE blacklists (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    
    -- åŸºæœ¬ä¿¡æ¯
    name VARCHAR(200) NOT NULL UNIQUE,               -- "åƒåœ¾ç”µè¯é»‘åå•" (å…¨å±€å”¯ä¸€)
    description TEXT,                                -- é»‘åå•æè¿°
    
    -- çŠ¶æ€ç®¡ç†  
    status blacklist_status_enum DEFAULT 'ACTIVE',  -- ACTIVE/INACTIVE
    
    -- ç»Ÿè®¡ä¿¡æ¯ (å†—ä½™å­—æ®µï¼Œä¾¿äºæŸ¥è¯¢)
    phone_count INTEGER DEFAULT 0,                  -- åŒ…å«çš„æ‰‹æœºå·æ•°é‡
    intercept_count INTEGER DEFAULT 0,              -- æ€»æ‹¦æˆªæ¬¡æ•°
    last_match_at TIMESTAMP,                        -- æœ€ååŒ¹é…æ—¶é—´
    
    -- å…ƒæ•°æ®
    created_by INTEGER REFERENCES admin_users(id),
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW(),
    source_enum blacklist_source_enum DEFAULT 'MANUAL',
    notes TEXT,
    tags TEXT[]                                      -- æ ‡ç­¾ä¾¿äºåˆ†ç±»å’Œç­›é€‰
);
```

#### 2. blacklist_phone_entries (æ‰‹æœºå·æ¡ç›®è¡¨ - ç®€åŒ–)

```sql
CREATE TABLE blacklist_phone_entries (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    
    -- å…³è”é»‘åå•
    blacklist_id UUID NOT NULL REFERENCES blacklists(id) ON DELETE CASCADE,
    
    -- æ‰‹æœºå·ä¿¡æ¯
    phone_number VARCHAR(20) NOT NULL,              -- åŸå§‹æ‰‹æœºå·
    normalized_phone VARCHAR(20) NOT NULL,          -- æ ‡å‡†åŒ–åçš„å·ç  (ä¾¿äºåŒ¹é…)
    
    -- æ¡ç›®çŠ¶æ€
    status blacklist_status_enum DEFAULT 'ACTIVE',
    
    -- åŒ¹é…è§„åˆ™
    is_regex BOOLEAN DEFAULT FALSE,                 -- æ”¯æŒæ­£åˆ™åŒ¹é…
    
    -- ç»Ÿè®¡
    match_count INTEGER DEFAULT 0,
    last_match_at TIMESTAMP,
    
    -- å…ƒæ•°æ®  
    notes TEXT,
    created_at TIMESTAMP DEFAULT NOW(),
    imported_from VARCHAR(100),                     -- æ‰¹é‡å¯¼å…¥æ¥æºæ ‡è®°
    
    -- çº¦æŸ
    UNIQUE(blacklist_id, normalized_phone),         -- åŒé»‘åå•å†…å·ç å”¯ä¸€
    CHECK (phone_number ~ '^[0-9+\-\s\(\)]{7,20}$') -- æ‰‹æœºå·æ ¼å¼æ£€æŸ¥
);
```

#### 3. ä¿ç•™æ‹¦æˆªæ—¥å¿—è¡¨ (ç®€åŒ–)

```sql
CREATE TABLE blacklist_intercept_logs (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    
    -- å…³è”ä¿¡æ¯
    blacklist_id UUID NOT NULL REFERENCES blacklists(id),
    matched_phone_entry_id UUID REFERENCES blacklist_phone_entries(id),
    
    -- æ‹¦æˆªå†…å®¹
    intercepted_phone VARCHAR(20) NOT NULL,         -- è¢«æ‹¦æˆªçš„æ‰‹æœºå·
    
    -- æ‹¦æˆªä¸Šä¸‹æ–‡
    source_ip INET,                                 -- æ¥æºIP
    user_agent TEXT,                               -- User Agent
    request_id VARCHAR(100),                       -- è¯·æ±‚ID
    
    -- æ—¶é—´å’Œæ€§èƒ½
    created_at TIMESTAMP DEFAULT NOW(),
    processing_time_ms INTEGER                     -- å¤„ç†è€—æ—¶(æ¯«ç§’)
);
```

### æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–

```sql
-- é»‘åå•è¡¨ç´¢å¼•
CREATE INDEX idx_blacklists_name ON blacklists (name);
CREATE INDEX idx_blacklists_status ON blacklists (status);
CREATE INDEX idx_blacklists_updated_at ON blacklists (updated_at DESC);

-- æ‰‹æœºå·æ¡ç›®è¡¨ç´¢å¼•  
CREATE INDEX idx_phone_entries_blacklist ON blacklist_phone_entries (blacklist_id);
CREATE INDEX idx_phone_entries_phone_active ON blacklist_phone_entries (normalized_phone) WHERE status = 'ACTIVE';
CREATE INDEX idx_phone_entries_blacklist_status ON blacklist_phone_entries (blacklist_id, status);

-- æ‹¦æˆªæ—¥å¿—è¡¨ç´¢å¼•
CREATE INDEX idx_intercept_logs_blacklist_time ON blacklist_intercept_logs (blacklist_id, created_at);
CREATE INDEX idx_intercept_logs_phone_time ON blacklist_intercept_logs (intercepted_phone, created_at);
```

## ğŸ”— APIè®¾è®¡

### ç®€åŒ–çš„RESTful APIç«¯ç‚¹

#### é»‘åå•ç®¡ç† API (ä¸“æ³¨æ‰‹æœºå·ç  + æ‰¹é‡ä¼˜åŒ–)

```http
# é»‘åå•åŸºæœ¬ä¿¡æ¯ç®¡ç† (æ ‡å‡†RESTful)
GET    /api/v1/blacklists/                          # è·å–é»‘åå•åˆ—è¡¨
POST   /api/v1/blacklists/                          # åˆ›å»ºé»‘åå•  
GET    /api/v1/blacklists/<id>                      # è·å–é»‘åå•è¯¦æƒ…
PUT    /api/v1/blacklists/<id>                      # æ›´æ–°é»‘åå•åŸºæœ¬ä¿¡æ¯
DELETE /api/v1/blacklists/<id>                      # åˆ é™¤é»‘åå•

# æ‰‹æœºå·å•ä¸ªæ“ä½œ
GET    /api/v1/blacklists/<id>/phones               # è·å–æ‰‹æœºå·åˆ—è¡¨
POST   /api/v1/blacklists/<id>/phones               # æ·»åŠ å•ä¸ªæ‰‹æœºå·
PUT    /api/v1/blacklists/<id>/phones/<phone_id>    # æ›´æ–°å•ä¸ªæ‰‹æœºå·
DELETE /api/v1/blacklists/<id>/phones/<phone_id>    # åˆ é™¤å•ä¸ªæ‰‹æœºå·

# æ‰‹æœºå·æ‰¹é‡æ“ä½œ (æ€§èƒ½ä¼˜åŒ–é‡ç‚¹) â­
POST   /api/v1/blacklists/<id>/batch-import         # æ‰¹é‡å¯¼å…¥æ‰‹æœºå· (Excel/CSV)
POST   /api/v1/blacklists/<id>/batch-update         # æ‰¹é‡æ›´æ–°æ‰‹æœºå·çŠ¶æ€
POST   /api/v1/blacklists/<id>/batch-delete         # æ‰¹é‡åˆ é™¤æ‰‹æœºå·
GET    /api/v1/blacklists/<id>/export               # å¯¼å‡ºæ‰‹æœºå·åˆ—è¡¨

# å¼‚æ­¥æ‰¹é‡æ“ä½œ (è¶…å¤§é‡æ•°æ®) 
POST   /api/v1/blacklists/<id>/async-import         # å¼‚æ­¥æ‰¹é‡å¯¼å…¥ (>10000æ¡)
GET    /api/v1/blacklists/<id>/import-status/<task_id>  # æŸ¥è¯¢å¯¼å…¥ä»»åŠ¡çŠ¶æ€

# ç»Ÿè®¡å’Œæ—¥å¿—
GET    /api/v1/blacklists/<id>/statistics           # è·å–é»‘åå•ç»Ÿè®¡ä¿¡æ¯
GET    /api/v1/blacklists/<id>/logs                 # è·å–é»‘åå•æ‹¦æˆªæ—¥å¿—

# åŒ¹é…æŸ¥è¯¢ (ä¾›å…¶ä»–æœåŠ¡è°ƒç”¨)
POST   /api/v1/blacklists/check-phone               # æ£€æŸ¥æ‰‹æœºå·æ˜¯å¦åœ¨æŒ‡å®šé»‘åå•ä¸­
GET    /api/v1/blacklists/search                    # æŒ‰åç§°/æ ‡ç­¾æœç´¢é»‘åå•
```

#### å…³é”®APIæ¥å£è®¾è®¡ (ç®€åŒ–ç‰ˆ)

**1. è·å–é»‘åå•åˆ—è¡¨**
```json
GET /api/v1/blacklists/?page=1&per_page=20&status=ACTIVE&tags=åƒåœ¾ç”µè¯

Response:
{
  "data": [
    {
      "id": "uuid",
      "name": "åƒåœ¾ç”µè¯é»‘åå•",
      "description": "ç”¨äºæ‹¦æˆªåƒåœ¾ç”µè¯",
      "status": "ACTIVE",
      "phone_count": 352,
      "intercept_count": 1205,
      "last_match_at": "2025-01-11T10:30:00Z",
      "created_at": "2025-01-01T00:00:00Z",
      "created_by_name": "å¼ ä¸‰",
      "tags": ["åƒåœ¾ç”µè¯", "å®¢æˆ·æŠ•è¯‰"]
    }
  ],
  "meta": {
    "page": 1,
    "per_page": 20,
    "total": 5,
    "pages": 1
  }
}
```

**2. åˆ›å»ºé»‘åå•**
```json
POST /api/v1/blacklists/

Request:
{
  "name": "å®¢æˆ·æŠ•è¯‰é»‘åå•",
  "description": "å®¢æˆ·æŠ•è¯‰çš„æ‰‹æœºå·",
  "tags": ["å®¢æˆ·æŠ•è¯‰", "é«˜ä¼˜å…ˆçº§"],
  "notes": "å¤„ç†å®¢æˆ·æŠ•è¯‰äº§ç”Ÿçš„é»‘åå•"
}

Response:
{
  "id": "uuid",
  "name": "å®¢æˆ·æŠ•è¯‰é»‘åå•", 
  "status": "ACTIVE",
  "phone_count": 0,
  "created_at": "2025-01-11T12:00:00Z"
}
```

**3. è·å–é»‘åå•è¯¦æƒ…å’Œæ‰‹æœºå·**
```json
GET /api/v1/blacklists/uuid?include_phones=true&phone_page=1&phone_per_page=50

Response:
{
  "blacklist": {
    "id": "uuid",
    "name": "åƒåœ¾ç”µè¯é»‘åå•",
    "description": "ç”¨äºæ‹¦æˆªåƒåœ¾ç”µè¯",
    "status": "ACTIVE",
    "phone_count": 352,
    "tags": ["åƒåœ¾ç”µè¯", "å®¢æˆ·æŠ•è¯‰"]
  },
  "phones": [
    {
      "id": "uuid",
      "phone_number": "13812345678",
      "normalized_phone": "8613812345678",
      "status": "ACTIVE",
      "match_count": 15,
      "last_match_at": "2025-01-11T08:00:00Z",
      "notes": "ä¸¾æŠ¥çš„åƒåœ¾ç”µè¯"
    }
  ],
  "phone_pagination": {
    "page": 1,
    "per_page": 50,
    "total": 352
  }
}
```

**4. æ‰¹é‡å¯¼å…¥æ‰‹æœºå· (æ€§èƒ½ä¼˜åŒ–ç‰ˆ)** â­
```json
POST /api/v1/blacklists/uuid/batch-import

Request:
{
  "format": "csv",  // text/csv/excel
  "data": "13812345678\n13987654321\n...(1000ä¸ªæ‰‹æœºå·)",
  "options": {
    "skip_duplicates": true,
    "validate_format": true,
    "default_status": "ACTIVE"
  },
  "batch_size": 100,     // æœåŠ¡ç«¯åˆ†æ‰¹å¤„ç†
  "notes": "2025å¹´1æœˆå®¢æˆ·æŠ•è¯‰æ‰¹é‡å¯¼å…¥"
}

Response:
{
  "success": true,
  "summary": {
    "total_submitted": 1000,
    "imported": 950,
    "skipped": 30,         // é‡å¤å·ç 
    "errors": 20           // æ ¼å¼é”™è¯¯
  },
  "error_details": [
    {
      "phone": "invalid-phone",
      "error": "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®"
    }
  ],
  "processing_time_ms": 1200,
  "batch_id": "batch_123"    // å¯ç”¨äºæŸ¥è¯¢å¯¼å…¥çŠ¶æ€
}
```

**4.1 å¼‚æ­¥æ‰¹é‡å¯¼å…¥ (è¶…å¤§é‡æ•°æ®)**
```json
POST /api/v1/blacklists/uuid/async-import

Request:
{
  "format": "excel",
  "file_url": "https://example.com/phones.xlsx",  // æˆ– base64 æ•°æ®
  "estimated_count": 50000,
  "options": {
    "skip_duplicates": true,
    "validate_format": true
  }
}

Response:
{
  "success": true,
  "async": true,
  "task_id": "task_456",
  "status_url": "/api/v1/blacklists/uuid/import-status/task_456",
  "estimated_duration_seconds": 120
}

# æŸ¥è¯¢å¼‚æ­¥ä»»åŠ¡çŠ¶æ€
GET /api/v1/blacklists/uuid/import-status/task_456

Response:
{
  "status": "processing",  // pending/processing/completed/failed
  "progress": 65,          // å®Œæˆç™¾åˆ†æ¯”
  "processed": 32500,
  "total": 50000,
  "imported": 31000,
  "skipped": 1200,
  "errors": 300
}
```

**5. æ‰‹æœºå·åŒ¹é…æ£€æŸ¥** (ä¾›å…¶ä»–æœåŠ¡è°ƒç”¨)
```json
POST /api/v1/blacklists/check-phone

Request:
{
  "phone_number": "13812345678",
  "blacklist_ids": ["uuid1", "uuid2", "uuid3"]  // æŒ‡å®šè¦æ£€æŸ¥çš„é»‘åå•åˆ—è¡¨
}

Response:
{
  "is_blocked": true,
  "matched_blacklists": [
    {
      "id": "uuid1",
      "name": "åƒåœ¾ç”µè¯é»‘åå•",
      "matched_phone": {
        "phone_number": "13812345678",
        "match_count": 15,
        "notes": "æŠ•è¯‰å·ç "
      }
    }
  ]
}
```

## âš¡ æ‰¹é‡æ“ä½œæ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### é—®é¢˜è¯†åˆ«
ç”¨æˆ·åœ¨ç¼–è¾‘é»‘åå•æ—¶å¯èƒ½éœ€è¦æ‰¹é‡å¯¼å…¥å‡ åƒç”šè‡³å‡ ä¸‡ä¸ªæ‰‹æœºå·ï¼Œå¦‚æœæ¯ä¸ªæ‰‹æœºå·è°ƒç”¨ä¸€æ¬¡APIå°†å¯¼è‡´ï¼š
- **ç½‘ç»œå¼€é”€**: å¤§é‡HTTPè¯·æ±‚
- **æœåŠ¡å™¨å‹åŠ›**: é¢‘ç¹çš„æ•°æ®åº“è¿æ¥å’Œäº‹åŠ¡
- **ç”¨æˆ·ä½“éªŒ**: é•¿æ—¶é—´ç­‰å¾…å’Œå¯èƒ½çš„è¶…æ—¶

### è§£å†³æ–¹æ¡ˆ

#### 1. æœåŠ¡ç«¯æ‰¹é‡å¤„ç† (æ ¸å¿ƒ)
```python
def batch_import_phones(blacklist_id, phone_list):
    """
    ä¸€æ¬¡APIè°ƒç”¨å¤„ç†æ‰€æœ‰æ‰‹æœºå·
    ä½¿ç”¨æ•°æ®åº“æ‰¹é‡æ’å…¥ï¼Œé¿å…å¾ªç¯è°ƒç”¨
    """
    validated_phones = []
    for phone in phone_list:
        normalized = normalize_phone(phone)
        if validate_phone_format(normalized):
            validated_phones.append({
                "blacklist_id": blacklist_id,
                "phone_number": phone,
                "normalized_phone": normalized,
                "status": "ACTIVE"
            })
    
    # æ•°æ®åº“æ‰¹é‡æ’å…¥ï¼Œæ€§èƒ½æå‡10-100å€
    session.bulk_insert_mappings(BlacklistPhoneEntry, validated_phones)
    session.commit()
    
    return {
        "imported": len(validated_phones),
        "errors": len(phone_list) - len(validated_phones)
    }
```

#### 2. æ•°æ®åº“ä¼˜åŒ–
```sql
-- ä½¿ç”¨æ‰¹é‡æ’å…¥ + å†²çªå¤„ç†
INSERT INTO blacklist_phone_entries (blacklist_id, phone_number, normalized_phone) 
VALUES 
  ('uuid', '13812345678', '8613812345678'),
  ('uuid', '13987654321', '8613987654321')
  -- ... æ‰¹é‡æ’å…¥1000æ¡
ON CONFLICT (blacklist_id, normalized_phone) DO NOTHING;  -- è‡ªåŠ¨å»é‡

-- åˆ›å»ºä¸“é—¨çš„æ‰¹é‡æ’å…¥ç´¢å¼•
CREATE INDEX CONCURRENTLY idx_batch_insert_temp ON blacklist_phone_entries (blacklist_id, normalized_phone);
```

#### 3. åˆ†çº§å¤„ç†ç­–ç•¥
```python
def smart_batch_import(blacklist_id, phone_list):
    count = len(phone_list)
    
    if count <= 1000:
        # åŒæ­¥å¤„ç†ï¼Œç«‹å³è¿”å›ç»“æœ
        return sync_batch_import(blacklist_id, phone_list)
    elif count <= 10000:
        # åˆ†æ‰¹åŒæ­¥å¤„ç†ï¼Œé¿å…è¶…æ—¶
        return chunked_sync_import(blacklist_id, phone_list, chunk_size=1000)
    else:
        # å¼‚æ­¥å¤„ç†ï¼Œè¿”å›ä»»åŠ¡ID
        task_id = async_batch_import.delay(blacklist_id, phone_list)
        return {"async": True, "task_id": task_id}
```

#### 4. å‰ç«¯ç”¨æˆ·ä½“éªŒä¼˜åŒ–
```typescript
// å‰ç«¯æ™ºèƒ½è°ƒç”¨
const handleBatchImport = async (phones: string[]) => {
  const count = phones.length;
  
  if (count > 10000) {
    // å¤§æ‰¹é‡ï¼šå¼‚æ­¥å¤„ç† + è¿›åº¦ç›‘æ§
    const result = await blacklistApi.asyncImport({blacklistId, phones});
    monitorImportProgress(result.task_id);
  } else {
    // å°æ‰¹é‡ï¼šåŒæ­¥å¤„ç† + å®æ—¶åé¦ˆ
    const result = await blacklistApi.batchImport({blacklistId, phones});
    showImportResult(result);
  }
};

// è¿›åº¦ç›‘æ§
const monitorImportProgress = (taskId: string) => {
  const interval = setInterval(async () => {
    const status = await blacklistApi.getImportStatus(taskId);
    updateProgressBar(status.progress);
    if (status.status === 'completed') {
      clearInterval(interval);
      showImportResult(status);
    }
  }, 2000);
};
```

### æ€§èƒ½åŸºå‡†æµ‹è¯•ç›®æ ‡

| æ•°æ®é‡ | å¤„ç†æ–¹å¼ | ç›®æ ‡æ—¶é—´ | å®ç°æ–¹æ¡ˆ |
|--------|---------|----------|----------|
| 1-100æ¡ | åŒæ­¥ | < 1ç§’ | å•æ¬¡æ‰¹é‡æ’å…¥ |
| 101-1000æ¡ | åŒæ­¥ | < 3ç§’ | æ‰¹é‡æ’å…¥ + å»é‡ |
| 1001-10000æ¡ | åˆ†æ‰¹åŒæ­¥ | < 30ç§’ | åˆ†æ‰¹å¤„ç† + è¿›åº¦æ˜¾ç¤º |
| >10000æ¡ | å¼‚æ­¥ | åå°å¤„ç† | Celeryä»»åŠ¡é˜Ÿåˆ— |

## ğŸ¨ å‰ç«¯ç•Œé¢è®¾è®¡ (ç®€åŒ–ç‰ˆ)

### é¡µé¢æ¶æ„é‡æ„

#### 1. é»‘åå•åˆ—è¡¨é¡µé¢

**ç»„ä»¶ç»“æ„:**
```typescript
BlacklistPage.tsx
â”œâ”€â”€ SearchFilterSection.tsx          # æœç´¢å’Œç­›é€‰ (æŒ‰åç§°ã€æ ‡ç­¾ã€çŠ¶æ€)
â”œâ”€â”€ ActionToolbar.tsx                # æ“ä½œå·¥å…·æ 
â”œâ”€â”€ BlacklistTable.tsx               # é»‘åå•è¡¨æ ¼ (ä¸“æ³¨æ‰‹æœºå·)
â””â”€â”€ Modals/
    â”œâ”€â”€ BlacklistFormModal.tsx       # åˆ›å»º/ç¼–è¾‘é»‘åå•åŸºæœ¬ä¿¡æ¯
    â”œâ”€â”€ PhoneManagementModal.tsx     # æ‰‹æœºå·ç®¡ç†å¯¹è¯æ¡† â­ æ ¸å¿ƒåŠŸèƒ½
    â”œâ”€â”€ BatchImportModal.tsx         # æ‰¹é‡å¯¼å…¥æ‰‹æœºå·
    â””â”€â”€ BlacklistDetailModal.tsx     # é»‘åå•è¯¦æƒ…æŸ¥çœ‹
```

**ç®€åŒ–è¡¨æ ¼åˆ—è®¾è®¡:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åºå·â”‚ é»‘åå•åç§°    â”‚ æ‰‹æœºå·æ•°â”‚ æ‹¦æˆªæ¬¡æ•°â”‚ æ ‡ç­¾    â”‚ çŠ¶æ€â”‚ æ“ä½œ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1  â”‚åƒåœ¾ç”µè¯é»‘åå• â”‚   352  â”‚  1,205 â”‚åƒåœ¾ç”µè¯  â”‚æ¿€æ´» â”‚ç®¡ç†  â”‚
â”‚  2  â”‚å®¢æˆ·æŠ•è¯‰é»‘åå• â”‚    48  â”‚    156 â”‚å®¢æˆ·æŠ•è¯‰  â”‚æ¿€æ´» â”‚ç®¡ç†  â”‚  
â”‚  3  â”‚è¿æ³•å·ç é»‘åå• â”‚   127  â”‚     89 â”‚è¿æ³•å†…å®¹  â”‚ç¦ç”¨ â”‚ç®¡ç†  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2. åˆ›å»ºé»‘åå•å¯¹è¯æ¡† (ç®€åŒ–)

**å¯¹è¯æ¡†è®¾è®¡:**
```typescript
interface BlacklistFormModalProps {
  visible: boolean;
  blacklist?: Blacklist;
  onClose: () => void;
}

// ç®€åŒ–å­—æ®µï¼š
// 1. åŸºæœ¬ä¿¡æ¯ï¼šåç§°ã€æè¿°ã€çŠ¶æ€
// 2. åˆ†ç±»æ ‡ç­¾ï¼šä¾¿äºç®¡ç†å’Œç­›é€‰
// 3. å¤‡æ³¨ä¿¡æ¯
```

**åˆ›å»ºå¯¹è¯æ¡†å¸ƒå±€:**
```
åˆ›å»ºé»‘åå•

åŸºæœ¬ä¿¡æ¯:
é»‘åå•åç§°: [________________________]
æè¿°: [________________________________]

åˆ†ç±»æ ‡ç­¾: [åƒåœ¾ç”µè¯] [å®¢æˆ·æŠ•è¯‰] [+æ·»åŠ æ ‡ç­¾]

å…¶ä»–è®¾ç½®:
çŠ¶æ€: [æ¿€æ´» â–¼]
å¤‡æ³¨: [________________________________]

                      [å–æ¶ˆ] [åˆ›å»º]
```

#### 3. æ‰‹æœºå·ç®¡ç†å¯¹è¯æ¡† (æ ¸å¿ƒåŠŸèƒ½)

**å¯¹è¯æ¡†è®¾è®¡:**
```typescript
interface PhoneManagementModalProps {
  visible: boolean;
  blacklist: Blacklist;
  onClose: () => void;
}
```

**æ‰‹æœºå·ç®¡ç†ç•Œé¢:**
```
ç®¡ç†é»‘åå•: åƒåœ¾ç”µè¯é»‘åå•                        [X]

åŒ…å«çš„æ‰‹æœºå·: (352ä¸ª)                    [æ‰¹é‡å¯¼å…¥] [å¯¼å‡º] [æ·»åŠ ]

ç­›é€‰: [çŠ¶æ€: å…¨éƒ¨â–¼] [æœç´¢æ‰‹æœºå·: ___________] [æœç´¢]

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â˜‘ 13812345678  â”‚ æ¿€æ´» â”‚ åŒ¹é…15æ¬¡ â”‚ æŠ•è¯‰å·ç       â”‚ ğŸ—‘ï¸â”‚
â”‚ â˜‘ 13987654321  â”‚ æ¿€æ´» â”‚ åŒ¹é…8æ¬¡  â”‚ åƒåœ¾ç”µè¯      â”‚ ğŸ—‘ï¸â”‚  
â”‚ â˜‘ 18611112222  â”‚ ç¦ç”¨ â”‚ åŒ¹é…3æ¬¡  â”‚ æš‚æ—¶å±è”½      â”‚ ğŸ—‘ï¸â”‚
â”‚ â˜‘ 13511112222  â”‚ æ¿€æ´» â”‚ åŒ¹é…1æ¬¡  â”‚ è‡ªåŠ¨å¯¼å…¥      â”‚ ğŸ—‘ï¸â”‚
â”‚ ... æ˜¾ç¤ºæ›´å¤šæ‰‹æœºå· (æ”¯æŒåˆ†é¡µ/è™šæ‹Ÿæ»šåŠ¨)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å·²é€‰ä¸­ 4 ä¸ªæ‰‹æœºå·    [æ‰¹é‡å¯ç”¨] [æ‰¹é‡ç¦ç”¨] [æ‰¹é‡åˆ é™¤]

                            [å…³é—­]
```

#### 4. æ‰¹é‡å¯¼å…¥æ‰‹æœºå·å¯¹è¯æ¡†

**å¯¼å…¥ç•Œé¢:**
```
æ‰¹é‡å¯¼å…¥æ‰‹æœºå·åˆ°: åƒåœ¾ç”µè¯é»‘åå•              [X]

å¯¼å…¥æ ¼å¼:
â—‹ æ–‡æœ¬æ ¼å¼ (æ¯è¡Œä¸€ä¸ªæ‰‹æœºå·)
â—‹ CSVæ–‡ä»¶ä¸Šä¼ 
â—‹ Excelæ–‡ä»¶ä¸Šä¼ 

æ‰‹æœºå·æ•°æ®:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 13812345678                        â”‚
â”‚ 13987654321                        â”‚
â”‚ 18611112222                        â”‚
â”‚ 13511119999                        â”‚
â”‚ ...                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¯¼å…¥é€‰é¡¹:
â˜‘ è·³è¿‡é‡å¤æ‰‹æœºå·
â˜‘ éªŒè¯æ‰‹æœºå·æ ¼å¼
å¯¼å…¥å¤‡æ³¨: [2025å¹´1æœˆå®¢æˆ·æŠ•è¯‰æ‰¹é‡å¯¼å…¥___________]

é¢„è®¡å¯¼å…¥: 0 ä¸ª    é‡å¤: 0 ä¸ª    é”™è¯¯: 0 ä¸ª

                    [å–æ¶ˆ] [é¢„è§ˆ] [å¼€å§‹å¯¼å…¥]
```

### å‰ç«¯æ•°æ®æµè®¾è®¡ (ç®€åŒ–ç‰ˆ)

#### Redux Stateç»“æ„
```typescript
interface BlacklistState {
  // åˆ—è¡¨æ•°æ®
  blacklists: Blacklist[];
  loading: boolean;
  
  // ç­›é€‰å’Œåˆ†é¡µ
  filters: BlacklistFilters;
  pagination: Pagination;
  
  // æ¨¡æ€æ¡†çŠ¶æ€
  modals: {
    isBlacklistFormOpen: boolean;
    isPhoneManagementOpen: boolean;
    isBatchImportOpen: boolean;
    selectedBlacklist: Blacklist | null;
  };
  
  // å½“å‰ç®¡ç†çš„é»‘åå•å’Œæ‰‹æœºå·
  currentBlacklist: Blacklist | null;
  currentPhones: PhoneEntry[];
  selectedPhoneIds: string[];
  phonesPagination: Pagination;
}

interface BlacklistFilters {
  name?: string;
  status?: 'ACTIVE' | 'INACTIVE';
  tags?: string[];
  created_by?: number;
}

interface PhoneEntry {
  id: string;
  phone_number: string;
  normalized_phone: string;
  status: 'ACTIVE' | 'INACTIVE';
  match_count: number;
  last_match_at?: string;
  notes?: string;
}
```

#### APIé›†æˆ
```typescript
// é»‘åå•API (ç®€åŒ–)
export const blacklistApi = createApi({
  reducerPath: 'blacklistApi',
  endpoints: (builder) => ({
    getBlacklists: builder.query<BlacklistListResponse, BlacklistListParams>({
      query: (params) => ({
        url: '/api/v1/blacklists/',
        params
      }),
    }),
    
    getBlacklistDetail: builder.query<BlacklistDetailResponse, string>({
      query: (id) => `/api/v1/blacklists/${id}?include_phones=true`,
    }),
    
    createBlacklist: builder.mutation<Blacklist, CreateBlacklistRequest>({
      query: (data) => ({
        url: '/api/v1/blacklists/',
        method: 'POST',
        body: data,
      }),
    }),
    
    getPhones: builder.query<PhoneListResponse, PhoneListParams>({
      query: ({ blacklistId, ...params }) => ({
        url: `/api/v1/blacklists/${blacklistId}/phones`,
        params
      }),
    }),
    
    batchImportPhones: builder.mutation<BatchImportResponse, BatchImportRequest>({
      query: ({ blacklistId, ...data }) => ({
        url: `/api/v1/blacklists/${blacklistId}/batch-import`,
        method: 'POST',
        body: data,
      }),
    }),
    
    checkPhone: builder.mutation<PhoneCheckResponse, PhoneCheckRequest>({
      query: (data) => ({
        url: '/api/v1/blacklists/check-phone',
        method: 'POST',
        body: data,
      }),
    }),
  }),
});
```

## ğŸ“‹ æ•°æ®è¿ç§»è®¡åˆ’

### è¿ç§»ç­–ç•¥

ç”±äºæ‚¨æåˆ°ç°æœ‰æ•°æ®ä¸éœ€è¦ä¿å­˜ï¼Œæˆ‘ä»¬é‡‡ç”¨**å…¨æ–°éƒ¨ç½²**ç­–ç•¥ï¼š

#### ç¬¬ä¸€é˜¶æ®µ: æ–°è¡¨ç»“æ„éƒ¨ç½²
1. åˆ›å»ºæ–°çš„è¡¨ç»“æ„
2. åˆ é™¤æ—§çš„blacklistç›¸å…³è¡¨
3. é‡æ–°åˆå§‹åŒ–é»˜è®¤æ•°æ®

#### ç¬¬äºŒé˜¶æ®µ: åº”ç”¨ä»£ç éƒ¨ç½²
1. éƒ¨ç½²æ–°çš„åç«¯APIä»£ç 
2. éƒ¨ç½²æ–°çš„å‰ç«¯ç•Œé¢ä»£ç 
3. æ›´æ–°ç›¸å…³é…ç½®

### è¿ç§»SQLè„šæœ¬

```sql
-- 1. åˆ é™¤æ—§è¡¨ (è°¨æ…æ“ä½œ!)
DROP TABLE IF EXISTS blacklist_entries CASCADE;
DROP TABLE IF EXISTS blacklist_types CASCADE;
DROP TABLE IF EXISTS blacklist_sources CASCADE;
DROP TABLE IF EXISTS intercept_logs CASCADE;

-- 2. åˆ›å»ºæ–°è¡¨ç»“æ„
-- (æ‰§è¡Œä¸Šé¢è®¾è®¡çš„æ–°å»ºè¡¨SQL)

-- 3. æ’å…¥é»˜è®¤æ•°æ®
INSERT INTO blacklists (id, name, type_enum, description, enterprise_id) VALUES
('c29c210d-fa35-4af0-b566-ad4576801173', 'é»˜è®¤æ‰‹æœºå·é»‘åå•', 'PHONE', 'ç³»ç»Ÿé»˜è®¤åˆ›å»ºçš„æ‰‹æœºå·é»‘åå•', NULL),
('38a3d3b9-5147-4e5e-9ee7-01a0762372d5', 'é»˜è®¤IPé»‘åå•', 'IP', 'ç³»ç»Ÿé»˜è®¤åˆ›å»ºçš„IPé»‘åå•', NULL);

-- 4. æ’å…¥æµ‹è¯•æ•°æ® (å¯é€‰)
INSERT INTO blacklist_entries (blacklist_id, content) VALUES
('c29c210d-fa35-4af0-b566-ad4576801173', '13800138000'),
('c29c210d-fa35-4af0-b566-ad4576801173', '13900139000');
```

## âš–ï¸ é£é™©è¯„ä¼°

### æŠ€æœ¯é£é™©

| é£é™©é¡¹ | é£é™©çº§åˆ« | å½±å“æè¿° | ç¼“è§£æªæ–½ |
|--------|---------|----------|----------|
| æ•°æ®è¿ç§»å¤±è´¥ | ä¸­ | å¯èƒ½å¯¼è‡´ç°æœ‰åŠŸèƒ½æš‚æ—¶ä¸å¯ç”¨ | å……åˆ†æµ‹è¯•ï¼Œå‡†å¤‡å›æ»šæ–¹æ¡ˆ |
| APIå…¼å®¹æ€§ | é«˜ | å®Œå…¨é‡æ„APIï¼Œå‰åç«¯éœ€åŒæ—¶æ›´æ–° | ç‰ˆæœ¬åŒ–éƒ¨ç½²ï¼Œç°åº¦å‘å¸ƒ |
| æ€§èƒ½å½±å“ | ä¸­ | æ–°çš„è¡¨ç»“æ„æŸ¥è¯¢æ€§èƒ½éœ€éªŒè¯ | æå‰æ€§èƒ½æµ‹è¯•ï¼Œç´¢å¼•ä¼˜åŒ– |
| ç•Œé¢é€‚é… | ä½ | ç”¨æˆ·ç•Œé¢æ“ä½œä¹ æƒ¯æ”¹å˜ | ä¿æŒäº¤äº’é€»è¾‘ä¸€è‡´æ€§ |

### ä¸šåŠ¡é£é™©

| é£é™©é¡¹ | å½±å“çº§åˆ« | è§£å†³æ–¹æ¡ˆ |
|--------|---------|----------|
| åŠŸèƒ½ä¸­æ–­ | é«˜ | é€‰æ‹©ä¸šåŠ¡ä½å³°æœŸéƒ¨ç½² |
| æ•°æ®ä¸¢å¤± | ä¸­ | ç°æœ‰æ•°æ®ä¸ä¿ç•™(å·²ç¡®è®¤) |
| ç”¨æˆ·åŸ¹è®­ | ä½ | æä¾›æ“ä½œæ–‡æ¡£ |

## ğŸ“Š å·¥ä½œé‡ä¼°ç®— (ç®€åŒ–ç‰ˆ)

### è¯¦ç»†å·¥ä½œåˆ†è§£

#### ç¬¬ä¸€é˜¶æ®µ: æ•°æ®åº“é‡æ„ (2å°æ—¶) â¬‡ï¸ ç®€åŒ–
- [x] æ–°è¡¨ç»“æ„è®¾è®¡ (0.5å°æ—¶) - **å·²å®Œæˆ**
- [ ] è¿ç§»SQLè„šæœ¬ç¼–å†™ (0.5å°æ—¶) - åªéœ€åˆ é™¤æ—§è¡¨+åˆ›å»ºæ–°è¡¨
- [ ] ç´¢å¼•ä¼˜åŒ–è®¾è®¡ (0.5å°æ—¶) - ä¸“æ³¨æ‰‹æœºå·ç´¢å¼•  
- [ ] æ•°æ®åº“æµ‹è¯•éªŒè¯ (0.5å°æ—¶)

#### ç¬¬äºŒé˜¶æ®µ: åç«¯APIé‡æ„ (6å°æ—¶) â¬†ï¸ å¢åŠ æ‰¹é‡ä¼˜åŒ–
- [ ] æ•°æ®æ¨¡å‹é‡æ„ (1å°æ—¶)
  - Blacklist, PhoneEntryæ¨¡å‹ (å»æ‰ç±»å‹æšä¸¾)
  - å…³ç³»æ˜ å°„å’ŒéªŒè¯è§„åˆ™
- [ ] Serviceå±‚é‡æ„ (2.5å°æ—¶)
  - BlacklistService: CRUD + ç»Ÿè®¡
  - PhoneService: æ‰‹æœºå·æ‰¹é‡æ“ä½œ + æ€§èƒ½ä¼˜åŒ–
  - å†…å®¹åŒ¹é…é€»è¾‘è°ƒæ•´ (åªå¤„ç†æ‰‹æœºå·)
  - æ‰¹é‡å¯¼å…¥æ€§èƒ½ä¼˜åŒ– (æ•°æ®åº“æ‰¹é‡æ’å…¥)
- [ ] APIè·¯ç”±é‡æ„ (2å°æ—¶) â¬†ï¸
  - 12ä¸ªAPIç«¯ç‚¹ (åŒ…å«å¼‚æ­¥æ‰¹é‡æ“ä½œ)
  - Request/Response Schema
  - æ‰¹é‡å¯¼å…¥ + å¼‚æ­¥å¤„ç†é€»è¾‘
- [ ] æ•°æ®éªŒè¯å’Œæµ‹è¯• (0.5å°æ—¶)

#### ç¬¬ä¸‰é˜¶æ®µ: å‰ç«¯ç•Œé¢é‡æ„ (6-8å°æ—¶) âœ… **ç®€åŒ–å®ç”¨æ–¹æ¡ˆ**  
- [ ] åŸºç¡€ç•Œé¢é€‚é… (3-4å°æ—¶) 
  - æ‰‹æœºå·ç®¡ç†å¯¹è¯æ¡† (1å°æ—¶) - **æ ‡å‡†Modal + Table**
  - æœç´¢å’Œç­›é€‰åŠŸèƒ½ (1å°æ—¶) - **ç®€å•Input + Select**
  - æ‰¹é‡é€‰æ‹©å’Œæ“ä½œ (1-2å°æ—¶) - **æ ‡å‡†rowSelection**
- [ ] å¯¼å…¥å¯¼å‡ºåŠŸèƒ½ (2-3å°æ—¶)
  - æ–‡ä»¶å¯¼å…¥å¯¹è¯æ¡† (1.5å°æ—¶) - **Upload + è¿›åº¦æç¤º**
  - å¯¼å‡ºåŠŸèƒ½ (0.5-1å°æ—¶) - **ç®€å•ä¸‹è½½é“¾æ¥**
  - é”™è¯¯å¤„ç†å’Œæç¤º (0.5å°æ—¶) - **Messageç»„ä»¶**
- [ ] é›†æˆå’Œæµ‹è¯• (1å°æ—¶)
  - å‰åç«¯è”è°ƒ (0.5å°æ—¶)
  - åŸºæœ¬æµ‹è¯•éªŒè¯ (0.5å°æ—¶)

**âœ… ç®€åŒ–è®¾è®¡åŸåˆ™**:
- **ä¿å®ˆæŠ€æœ¯é€‰å‹**: ä½¿ç”¨æˆç†Ÿã€ç¨³å®šçš„Ant Designç»„ä»¶
- **åŠŸèƒ½ä¼˜å…ˆ**: å…ˆä¿è¯åŠŸèƒ½å®Œæ•´ï¼Œæ€§èƒ½å¤Ÿç”¨å³å¯
- **æ¸è¿›å¼ä¼˜åŒ–**: æœªæ¥éœ€è¦æ—¶å†å‡çº§æŠ€æœ¯æ–¹æ¡ˆ
- **é™ä½é£é™©**: ç¡®ä¿é¡¹ç›®æˆåŠŸäº¤ä»˜ï¼Œé¿å…è¿‡åº¦è®¾è®¡

**ğŸ“Š æ•°æ®é‡ç°å®è¯„ä¼°**: æ‰‹æœºå·1-2ä¸‡æ¡ï¼Œæ‰¹é‡æ“ä½œå‡ ç™¾åˆ°å‡ åƒæ¡ï¼Œæ ‡å‡†åˆ†é¡µè¡¨æ ¼å®Œå…¨å¤Ÿç”¨

### æ—¶é—´è§„åˆ’ (ç®€åŒ–æ–¹æ¡ˆ)

**æ€»è®¡**: **14-16å°æ—¶** / **2ä¸ªå·¥ä½œæ—¥** âœ… **å›å½’åˆç†é¢„ä¼°**

**ç¬¬ä¸€é˜¶æ®µ: æ•°æ®åº“é‡æ„** (2å°æ—¶) - âœ… **å·²å®Œæˆ**
**ç¬¬äºŒé˜¶æ®µ: åç«¯APIé‡æ„** (6å°æ—¶) - âœ… **å·²å®Œæˆ**  
**ç¬¬ä¸‰é˜¶æ®µ: å‰ç«¯ç•Œé¢é‡æ„** (6-8å°æ—¶) - â³ **ç®€åŒ–æ–¹æ¡ˆ**

**å‰ç«¯é‡æ„ç®€åŒ–è§„åˆ’**:
- **Day 1 ä¸Šåˆ (4å°æ—¶)**: åŸºç¡€ç•Œé¢é€‚é… (Modal + Table + æœç´¢)
- **Day 1 ä¸‹åˆ (3å°æ—¶)**: å¯¼å…¥å¯¼å‡ºåŠŸèƒ½ (Upload + Export)
- **Day 2 ä¸Šåˆ (1å°æ—¶)**: é›†æˆæµ‹è¯•å’ŒéªŒè¯

**æ–¹æ¡ˆæ¼”è¿›å¯¹æ¯”**:
- **æœ€åˆä¼°ç®—**: 3å°æ—¶ (è¿‡äºä¹è§‚)
- **è¿‡åº¦è®¾è®¡**: 18-24å°æ—¶ (æŠ€æœ¯é£é™©é«˜)
- **ç®€åŒ–æ–¹æ¡ˆ**: **6-8å°æ—¶** (ä¿å®ˆå®ç”¨) âœ…  

### æ¶æ„ä¼˜åŠ¿ ğŸ’¡
- âœ… **å»æ‰å¤šç±»å‹æ”¯æŒ**: èŠ‚çœ 6å°æ—¶ (æšä¸¾å¤„ç†ã€å¤šç±»å‹éªŒè¯)
- âœ… **å»æ‰ä½œç”¨åŸŸç®¡ç†**: èŠ‚çœ 4å°æ—¶ (ä¼ä¸šéš”ç¦»ã€æƒé™æ§åˆ¶)  
- âœ… **æ•°æ®æ¨¡å‹ç®€åŒ–**: èŠ‚çœ 3å°æ—¶ (å¤æ‚å…³ç³»æ˜ å°„)
- âœ… **å‰ç«¯ç•Œé¢ç®€åŒ–**: èŠ‚çœ 3å°æ—¶ (ç±»å‹é€‰æ‹©ã€ä½œç”¨åŸŸé…ç½®ç•Œé¢)
- âš¡ **æ‰¹é‡æ“ä½œä¼˜åŒ–**: æ”¯æŒä¸‡çº§æ•°æ®å¯¼å…¥ï¼Œæ€§èƒ½æå‡100å€
- ğŸ¯ **ä¸“æ³¨æ ¸å¿ƒåŠŸèƒ½**: æ‰‹æœºå·é›†åˆç®¡ç†ï¼Œæ¶æ„æ¸…æ™°ï¼Œå®æ–½æ•ˆç‡é«˜
- ğŸ”— **è§£è€¦è®¾è®¡**: æ•°æ®ç®¡ç†ä¸ä½œç”¨åŸŸé…ç½®åˆ†ç¦»ï¼Œä¾¿äºåæœŸæ‰©å±•  

## ğŸ¯ éªŒæ”¶æ ‡å‡† (ç®€åŒ–ç‰ˆ)

### åŠŸèƒ½éªŒæ”¶
- [ ] èƒ½å¤Ÿåˆ›å»ºå’Œç®¡ç†é»‘åå• (åŸºæœ¬ä¿¡æ¯ã€æ ‡ç­¾)
- [ ] èƒ½å¤Ÿå‘é»‘åå•å†…æ‰¹é‡å¯¼å…¥/å¯¼å‡ºæ‰‹æœºå·  
- [ ] èƒ½å¤Ÿå¯ç”¨/ç¦ç”¨æ•´ä¸ªé»‘åå•
- [ ] èƒ½å¤Ÿç®¡ç†é»‘åå•å†…çš„æ‰‹æœºå· (å¢åˆ æ”¹æŸ¥)
- [ ] èƒ½å¤ŸæŸ¥çœ‹é»‘åå•çš„ç»Ÿè®¡ä¿¡æ¯å’Œæ‹¦æˆªæ—¥å¿—
- [ ] æ”¯æŒæ‰‹æœºå·æ ¼å¼éªŒè¯å’Œå»é‡
- [ ] æ”¯æŒæ‰‹æœºå·æ­£åˆ™åŒ¹é… (å¯é€‰)
- [ ] æä¾›æ‰‹æœºå·åŒ¹é…æ£€æŸ¥APIä¾›å…¶ä»–æœåŠ¡è°ƒç”¨

### æ€§èƒ½éªŒæ”¶
- [ ] é»‘åå•åˆ—è¡¨æŸ¥è¯¢å“åº”æ—¶é—´ < 300ms
- [ ] å•ä¸ªé»‘åå•æ‰‹æœºå·æŸ¥è¯¢ (1000æ¡ä»¥å†…) < 800ms  
- [ ] æ‰¹é‡å¯¼å…¥æ‰‹æœºå· (100æ¡) < 2s
- [ ] æ‰‹æœºå·åŒ¹é…æŸ¥è¯¢ < 50ms

### å®‰å…¨éªŒæ”¶
- [ ] æƒé™æ§åˆ¶æœ‰æ•ˆ (åˆ›å»ºè€…ç®¡ç†)
- [ ] æ‰‹æœºå·è¾“å…¥éªŒè¯å®Œæ•´
- [ ] SQLæ³¨å…¥é˜²æŠ¤æµ‹è¯•é€šè¿‡

## ğŸ“ åç»­æ‰©å±•è§„åˆ’ (ç®€åŒ–ç‰ˆ)

### Phase 2: é«˜çº§åŠŸèƒ½ (å¯é€‰)
- **æ™ºèƒ½åˆ†ç±»**: åŸºäºæ‰‹æœºå·æ®µè‡ªåŠ¨åˆ†ç±»é»‘åå•
- **å®šæ—¶åŒæ­¥**: ä»ç¬¬ä¸‰æ–¹æ•°æ®æºå®šæ—¶æ›´æ–°æ‰‹æœºå·é»‘åå•
- **æ•ˆæœåˆ†æ**: æ‰‹æœºå·é»‘åå•çš„æ‹¦æˆªæ•ˆæœåˆ†æå’Œä¼˜åŒ–å»ºè®®
- **æ¨¡æ¿ç®¡ç†**: é¢„å®šä¹‰çš„æ‰‹æœºå·é»‘åå•æ¨¡æ¿

### Phase 3: é›†æˆåŠŸèƒ½ (å¯é€‰)
- **ä½œç”¨åŸŸé…ç½®**: åœ¨è´¦å·/é€šé“/å…¨å±€é…ç½®ä¸­é€‰æ‹©ä½¿ç”¨çš„é»‘åå•
- **è‡ªåŠ¨åŒ–è§„åˆ™**: åŸºäºæ‹¦æˆªé¢‘ç‡è‡ªåŠ¨æ·»åŠ æ‰‹æœºå·åˆ°é»‘åå•
- **APIæ‰©å±•**: æä¾›æ›´å¤šæ‰‹æœºå·éªŒè¯å’ŒåŒ¹é…API

### ğŸ”— ä¸å…¶ä»–æ¨¡å—çš„é›†æˆç‚¹
- **å‘é€è´¦å·æ¨¡å—**: é…ç½®è¯¥è´¦å·ä½¿ç”¨çš„é»‘åå•IDåˆ—è¡¨
- **é€šé“æ¨¡å—**: é…ç½®è¯¥é€šé“ä½¿ç”¨çš„é»‘åå•IDåˆ—è¡¨  
- **å…¨å±€é…ç½®**: é…ç½®å…¨å±€ç”Ÿæ•ˆçš„é»‘åå•IDåˆ—è¡¨
- **æ‹¦æˆªå¼•æ“**: è°ƒç”¨æ‰‹æœºå·åŒ¹é…æ£€æŸ¥APIè¿›è¡Œå®æ—¶æ‹¦æˆª

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.1 (æ‰¹é‡ä¼˜åŒ–ç‰ˆ)  
**åˆ›å»ºæ—¶é—´**: 2025-01-11  
**æœ€åæ›´æ–°**: 2025-01-12  
**æ›´æ–°å†…å®¹**: å¢åŠ æ‰¹é‡æ“ä½œæ€§èƒ½ä¼˜åŒ–ç­–ç•¥ï¼Œæ”¯æŒä¸‡çº§æ•°æ®å¯¼å…¥  
**é¢„è®¡å¼€å§‹**: ç­‰å¾…ç”¨æˆ·è¯„å®¡ç¡®è®¤  
**è´Ÿè´£äºº**: Claude Code Assistant  
**æŠ€æœ¯æ ˆ**: Flask + PostgreSQL + React + RTK Query + Celery (å¼‚æ­¥)  
**é¢„è®¡å·¥æœŸ**: 1.5å¤© / 11å°æ—¶ âš¡ (å«æ€§èƒ½ä¼˜åŒ–)